# é›†ç¾¤ä»»åŠ¡è¶…æ—¶æœºåˆ¶è¯´æ˜

## ğŸ“‹ å‚æ•°é…ç½®

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ | ç”¨é€” |
|------|--------|------|------|
| `step_timeout` | 25ç§’ | æ­¥éª¤è¶…æ—¶æ—¶é—´ | ç­‰å¾…USVå“åº”ç›®æ ‡ç‚¹çš„æ—¶é—´ |
| `max_retries` | 3æ¬¡ | æœ€å¤§é‡è¯•æ¬¡æ•° | è¶…æ—¶åé‡è¯•å‘é€çš„æ¬¡æ•° |
| `cluster_action_timeout` | 300ç§’ | å¯¼èˆªè¶…æ—¶æ—¶é—´ | USVå®é™…å¯¼èˆªå…è®¸çš„æœ€é•¿æ—¶é—´ |
| `min_ack_rate_for_proceed` | 80% | æœ€å°ç¡®è®¤ç‡ | è¶…è¿‡æ­¤æ¯”ä¾‹å¯è¿›å…¥ä¸‹ä¸€æ­¥ |

## ğŸ”„ è¶…æ—¶æœºåˆ¶å·¥ä½œæµç¨‹

### 1. å‘é€ç›®æ ‡ç‚¹
```
T=0s: å‘USVå‘é€ç›®æ ‡ç‚¹
      è®°å½• last_send_time = 0
```

### 2. æ­¥éª¤è¶…æ—¶æ£€æŸ¥ï¼ˆstep_timeoutï¼‰
```
å®šæ—¶å™¨æ¯5ç§’æ£€æŸ¥ä¸€æ¬¡ï¼š
  elapsed = now - last_send_time
  if elapsed > step_timeout (25ç§’):
      è§¦å‘è¶…æ—¶å¤„ç†
```

### 3. è¶…æ—¶å¤„ç†æµç¨‹
```
if retry < max_retries (3æ¬¡):
    retry += 1
    é‡æ–°å‘é€ç›®æ ‡ç‚¹
    æ›´æ–° last_send_time
    ç»§ç»­ç­‰å¾…
else:
    æ ‡è®°ä¸ºå¤±è´¥
    ä¸å†é‡è¯•
```

### 4. æ€»è¶…æ—¶æ—¶é—´è®¡ç®—
```
é¦–æ¬¡å‘é€: 25ç§’ç­‰å¾…
é‡è¯•1æ¬¡:  25ç§’ç­‰å¾…
é‡è¯•2æ¬¡:  25ç§’ç­‰å¾…
é‡è¯•3æ¬¡:  25ç§’ç­‰å¾…
-------------------
æ€»è®¡:    100ç§’ï¼ˆ4æ¬¡å°è¯• Ã— 25ç§’ï¼‰
```

## âš ï¸ é‡è¦æ¦‚å¿µåŒºåˆ†

### step_timeout vs action_timeout

| ç‰¹æ€§ | step_timeout | action_timeout |
|------|--------------|----------------|
| **å«ä¹‰** | ç­‰å¾…USVå“åº”çš„æ—¶é—´ | USVå®é™…å¯¼èˆªçš„æ—¶é—´ |
| **é»˜è®¤å€¼** | 25ç§’ | 300ç§’ |
| **ç”¨é€”** | æ£€æµ‹USVæ˜¯å¦åœ¨çº¿ | å…è®¸å¯¼èˆªèŠ±è´¹çš„æ—¶é—´ |
| **è§¦å‘æ¡ä»¶** | å‘é€åæ— å“åº” | å¯¼èˆªä¸­è¶…è¿‡æ—¶é™ |
| **ç»“æœ** | é‡è¯•å‘é€ç›®æ ‡ | å¯¼èˆªä»»åŠ¡è¶…æ—¶å¤±è´¥ |

## ğŸ¯ å¯¼èˆªå®Œæˆvsä»»åŠ¡å®Œæˆ

### ä¹‹å‰çš„é—®é¢˜ï¼ˆå·²ä¿®å¤ï¼‰
```
Step 1: usv_01åˆ°è¾¾ç›®æ ‡ â†’ âŒ ç«‹å³åˆ‡æ¢HOLD
Step 2: å‘é€æ–°ç›®æ ‡     â†’ USVåœ¨HOLDæ¨¡å¼ä¸‹å¯¼èˆªï¼ˆä¸ç†æƒ³ï¼‰
```

### ä¿®å¤åçš„é€»è¾‘
```
Step 1: usv_01åˆ°è¾¾ç›®æ ‡ â†’ âœ… ä¿æŒGUIDEDæ¨¡å¼
Step 2: å‘é€æ–°ç›®æ ‡     â†’ âœ… USVåœ¨GUIDEDæ¨¡å¼ä¸‹å¯¼èˆª
...
æ‰€æœ‰æ­¥éª¤å®Œæˆ        â†’ âœ… ç»Ÿä¸€åˆ‡æ¢åˆ°HOLDæ¨¡å¼
```

## ğŸ“Š å®é™…åœºæ™¯ç¤ºä¾‹

### åœºæ™¯1ï¼šå¿«é€Ÿå“åº”ï¼ˆæ­£å¸¸ï¼‰
```
T=0s:   å‘é€ç›®æ ‡ç‚¹
T=0.5s: USVå¼€å§‹å¯¼èˆª
T=30s:  USVåˆ°è¾¾ç›®æ ‡
ç»“æœ: âœ… æˆåŠŸï¼Œæ— è¶…æ—¶
```

### åœºæ™¯2ï¼šæ…¢é€Ÿå“åº”ï¼ˆéœ€è¦é‡è¯•ï¼‰
```
T=0s:   å‘é€ç›®æ ‡ç‚¹
T=26s:  step_timeoutè§¦å‘ â†’ é‡è¯•ç¬¬1æ¬¡
T=27s:  USVæ”¶åˆ°ç›®æ ‡å¹¶å¼€å§‹å¯¼èˆª
T=90s:  USVåˆ°è¾¾ç›®æ ‡
ç»“æœ: âœ… æˆåŠŸï¼ˆç»è¿‡1æ¬¡é‡è¯•ï¼‰
```

### åœºæ™¯3ï¼šUSVç¦»çº¿ï¼ˆå¤±è´¥ï¼‰
```
T=0s:   å‘é€ç›®æ ‡ç‚¹
T=25s:  è¶…æ—¶ â†’ é‡è¯•ç¬¬1æ¬¡
T=50s:  è¶…æ—¶ â†’ é‡è¯•ç¬¬2æ¬¡
T=75s:  è¶…æ—¶ â†’ é‡è¯•ç¬¬3æ¬¡
T=100s: è¶…æ—¶ â†’ è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œæ ‡è®°å¤±è´¥
ç»“æœ: âŒ å¤±è´¥ï¼ˆUSVå¯èƒ½ç¦»çº¿ï¼‰
```

### åœºæ™¯4ï¼šå¯¼èˆªæ—¶é—´é•¿ï¼ˆæ­£å¸¸ä½†æ…¢ï¼‰
```
T=0s:   å‘é€ç›®æ ‡ç‚¹
T=1s:   USVå¼€å§‹å¯¼èˆª
T=250s: USVä»åœ¨å¯¼èˆªä¸­ï¼ˆè·ç¦»å¾ˆè¿œï¼‰
T=280s: USVåˆ°è¾¾ç›®æ ‡
ç»“æœ: âœ… æˆåŠŸï¼ˆè™½ç„¶èŠ±äº†280ç§’ï¼Œä½†åœ¨300ç§’é™åˆ¶å†…ï¼‰
```

## ğŸ”§ å¦‚ä½•è°ƒæ•´å‚æ•°

### å¦‚æœUSVç»å¸¸è¶…æ—¶ä½†å®é™…åœ¨æ­£å¸¸å¯¼èˆª

**é—®é¢˜**ï¼š`step_timeout` å¤ªçŸ­

**è§£å†³æ–¹æ¡ˆ**ï¼š
```yaml
# gs_params.yaml
step_timeout: 30.0  # å¢åŠ åˆ°30ç§’
max_retries: 4      # å¢åŠ é‡è¯•æ¬¡æ•°
```

### å¦‚æœå¸Œæœ›æ›´å¿«åœ°æ£€æµ‹USVç¦»çº¿

**è§£å†³æ–¹æ¡ˆ**ï¼š
```yaml
step_timeout: 15.0  # å‡å°‘åˆ°15ç§’
max_retries: 2      # å‡å°‘é‡è¯•æ¬¡æ•°
```

### å¦‚æœå¯¼èˆªè·ç¦»å¾ˆè¿œéœ€è¦æ›´é•¿æ—¶é—´

**è§£å†³æ–¹æ¡ˆ**ï¼š
```yaml
cluster_action_timeout: 600.0  # å¢åŠ åˆ°10åˆ†é’Ÿ
```

## ğŸ“ˆ ç›‘æ§å»ºè®®

è§‚å¯Ÿæ—¥å¿—ä¸­çš„å…³é”®ä¿¡æ¯ï¼š
```
âš ï¸  usv_01 è¶…æ—¶ï¼Œé‡è¯•ç¬¬ 1 æ¬¡  â†’ å¯èƒ½éœ€è¦å¢åŠ step_timeout
âœ…  usv_01 å¯¼èˆªå®Œæˆ            â†’ æ­£å¸¸
âŒ  usv_01 è¶…æ—¶ä¸”å·²è¾¾æœ€å¤§é‡è¯•æ¬¡æ•° â†’ USVå¯èƒ½ç¦»çº¿æˆ–å‚æ•°è¿‡å°
```

## ğŸ¯ æœ€ä½³å®è·µ

1. **step_timeout**: è®¾ç½®ä¸ºUSVæ­£å¸¸å“åº”æ—¶é—´çš„2-3å€
2. **max_retries**: è®¾ç½®ä¸º3-5æ¬¡ï¼Œç»™è¶³å¤Ÿçš„é‡è¯•æœºä¼š
3. **cluster_action_timeout**: è®¾ç½®ä¸ºæœ€è¿œç›®æ ‡ç‚¹å¯¼èˆªæ—¶é—´çš„1.5-2å€
4. **min_ack_rate_for_proceed**: ä¿æŒ80%ï¼Œå…è®¸å°‘æ•°USVå¤±è´¥

## âš¡ å¿«é€Ÿé…ç½®å‚è€ƒ

### å®¤å†…/å°èŒƒå›´æµ‹è¯•ç¯å¢ƒ
```yaml
step_timeout: 20.0
max_retries: 3
cluster_action_timeout: 180.0  # 3åˆ†é’Ÿ
```

### å®¤å¤–/å¤§èŒƒå›´ä½œä¸šç¯å¢ƒ
```yaml
step_timeout: 30.0
max_retries: 4
cluster_action_timeout: 600.0  # 10åˆ†é’Ÿ
```

### é«˜å¯é æ€§è¦æ±‚ç¯å¢ƒ
```yaml
step_timeout: 35.0
max_retries: 5
cluster_action_timeout: 900.0  # 15åˆ†é’Ÿ
min_ack_rate_for_proceed: 1.0  # è¦æ±‚100%æˆåŠŸ
```
