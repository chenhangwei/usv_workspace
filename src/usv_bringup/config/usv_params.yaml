# =============================================================================
# USV系统参数配置文件
# 该文件定义了USV系统中各节点的参数配置
# =============================================================================

# =============================================================================
# 飞控通信模块参数 (MAVROS)
# =============================================================================
# 注意：插件白名单现在在 launch 文件中配置，此处仅保留其他参数
mavros_node:
  ros__parameters:
    # 连接参数
    conn:
      timeout: 5.0                          # 连接超时时间（秒）
      heartbeat_mav_type: 6                 # MAV_TYPE_SURFACE_BOAT
      heartbeat_rate: 1.0                   # 心跳频率（Hz）
    
    # 禁用参数同步，避免启动延迟
    param:
      use_mission_item_int: false           # 禁用任务项参数同步
      
    # 视觉定位配置
    vision_pose:
      enable: false                         # 禁用视觉定位

# =============================================================================
# 通信与状态管理模块参数
# =============================================================================
usv_status_node:
  ros__parameters:
    # 目标点判断阈值
    target_reach_threshold: 1.0             # 到达目标点的距离阈值（米）
    
    # 电池电压范围配置（基于实际电池特性）
    battery_voltage_full: 12.6              # 满电电压（V）- 电量显示100%
    battery_voltage_empty: 10.8             # 空电电压（V）- 电量显示0%，需要充电

auto_set_home_node:
  ros__parameters:
    # Home点设置延迟
    set_delay_sec: 3.0                      # 接收到第一个位置消息后设置EKF原点的延迟时间（秒）
    
    # ⚠️ 重要说明：
    # use_current_gps: false 表示使用固定的A0基站坐标作为Home点
    # 所有USV共享同一个Home点（A0基站），这样所有USV的本地坐标系都统一以A0为原点
    # 这是多USV系统的关键设计：全局坐标系 = USV本地坐标系 = 以A0为原点
    use_current_gps: false                  # false=使用A0基站坐标，true=使用USV当前位置（不推荐）
    
    # A0定位基站的GPS坐标（所有USV共享的坐标系原点）
    home_latitude: 22.5180977               # 基站纬度（北纬）
    home_longitude: 113.9007239             # 基站经度（东经）
    home_altitude: -4.8                     # 基站高度（米，相对海平面）
    
    retry_interval: 1.0                     # 重试发送命令的时间间隔（秒）
    max_retries: 30                         # 最大重试次数

# =============================================================================
# 控制模块参数
# =============================================================================
usv_avoidance_node:
  ros__parameters:
    # 避障距离参数
    in_distance_value: 1.0                  # 避障触发距离（米）

usv_command_node:
  ros__parameters:
    # 支持的飞行模式列表
    supported_modes: ['GUIDED', 'MANUAL', 'AUTO', 'HOLD', 'ARCO', 'STEERING']
    # 服务超时时间
    service_timeout_sec: 5.0                # 服务等待超时时间（秒）
    # 解锁命令超时时间
    arming_command_timeout_sec: 10.0        # 解锁命令超时时间（秒）

usv_control_node:
  ros__parameters:
    dummy_param: true                       # 占位参数

# =============================================================================
# 传感器驱动模块参数
# =============================================================================
usv_uwb_node:
  ros__parameters:
    dummy_param: true                       # 占位参数

# =============================================================================
# 辅助功能模块参数
# =============================================================================
usv_head_action_node:
  ros__parameters:
    # 默认为无硬件模式，避免在无 I2C/PCA9685 环境崩溃
    enable_head_actuator: false            # 设置为 true 以启用实际硬件控制

usv_fan_node:
  ros__parameters:
    # 风扇控制引脚配置
    fan_pin: 17                             # BCM编号，GPIO17
    gpio_chip: gpiochip4                    # GPIO芯片名称
    # 温度阈值配置（单位：毫摄氏度）
    temp_threshold_on: 50000                # 风扇开启温度阈值 50°C
    temp_threshold_off: 45000               # 风扇关闭温度阈值 45°C

usv_led_node:
  ros__parameters:
    # LED控制串口配置
    port: /dev/ttyUSB1                      # 串口设备路径
    baudrate: 115200                        # 波特率
    # LED效果配置
    color_list: [255, 0, 0, 255, 127, 0, 255, 255, 0, 0, 255, 0, 0, 255, 255, 0, 0, 255, 139, 0, 255]  # 颜色列表 [R,G,B,R,G,B,...]
    timer_period_high: 0.03                 # 高频定时器周期（秒）
    timer_period_low: 0.5                   # 低频定时器周期（秒）
    transition_duration: 3.0                # 颜色渐变持续时间（秒）
    hold_duration: 10.0                     # 颜色停留时间（秒）
    
    # ⚠️ 电池低电量判断 - 基于飞控百分比（需要在 QGroundControl 中配置 BATT_CAPACITY）
    low_battery_percentage: 10.0            # 低电量百分比阈值（%）- 低于此值进入红色呼吸灯
    recover_battery_percentage: 15.0        # 恢复电量百分比阈值（%）- 高于此值退出红色呼吸灯
    breath_step: 6                          # 呼吸灯步进值

usv_sound_node:
  ros__parameters:
    # 声音播放配置
    # ⚠️ 低电量判断 - 基于飞控百分比（需要在 QGroundControl 中配置 BATT_CAPACITY）
    low_battery_percentage: 10.0            # 低电量百分比阈值（%）
    
    sound_types: ['gaga101', 'gaga102', 'gaga103', 'gaga104']  # 常规声音类型列表
    moon_type: 'moon101'                    # 低电量声音类型
    min_play_interval: 2                    # 最小播放间隔（秒）
    max_play_interval: 10                   # 最大播放间隔（秒）
    min_play_count: 1                       # 最小播放次数
    max_play_count: 3                       # 最大播放次数