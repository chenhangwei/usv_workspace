<?xml version="1.0" encoding="UTF-8"?>
<cluster type="triangle">
    <!--
      单位约定：
        - yaw 均为弧度(rad)
        - position 为米(m)

      语义约定（与当前代码一致）：
        - yaw：随 navigation/goal 下发（带 feedback/result 完成度）
        - sync: true/false (true: 等待同组完成; false: 不等待)
        - led: color_select|r,g,b 或 led_off (控制灯光)

      velocity：当前仅被解析但不会影响 PX4 setpoint（可保留作未来扩展，不填写也不影响）。
    -->
    
    <!-- 步骤 1: 编队集结 (同步, 演示独立颜色: 01红/02蓝/03黄) -->
    <step number="1" sync="true">
        <usvs>
            <!-- USV_01: 红色 (255,0,0) -->
            <usv led="color_select|255,0,0">
                <usv_id>usv_01</usv_id>
                <position>
                    <x>5.0</x>
                    <y>5.0</y>
                    <z>0.0</z>
                </position>
                <!-- mode="auto": 不采用yaw, 飞控自动决定朝向 (推荐新写法) -->
                <yaw mode="auto" />
                <velocity>
                    <value>0.5</value>
                </velocity>
            </usv>
            <!-- USV_02: 蓝色 (0,0,255) -->
            <usv led="color_select|0,0,255">
                <usv_id>usv_02</usv_id>
                <position>
                    <x>6.0</x>
                    <y>6.0</y>
                    <z>0.0</z>
                </position>
                <!-- 兼容旧写法 -->
                <yaw use="false">0</yaw>
                <velocity>
                    <value>0.5</value>
                </velocity>
            </usv>
            <!-- USV_03: 黄色 (255,255,0) -->
            <usv led="color_select|255,255,0">
                <usv_id>usv_03</usv_id>
                <position>
                    <x>7.0</x>
                    <y>7.0</y>
                    <z>0.0</z>
                </position>
                <yaw mode="auto" />
                <velocity>
                    <value>0.5</value>
                </velocity>
            </usv>
        </usvs>
    </step>

      <step number="2" sync="false">
        <usvs>
            <!-- USV_01: 红色 (255,0,0) -->
            <usv led="color_select|255,0,0">
                <usv_id>usv_01</usv_id>
                <position>
                    <x>-5.0</x>
                    <y>-5.0</y>
                    <z>0.0</z>
                </position>
                <!-- mode="auto": 不采用yaw, 飞控自动决定朝向 (推荐新写法) -->
                <yaw mode="auto" />
                <velocity>
                    <value>0.5</value>
                </velocity>
            </usv>
            <!-- USV_02: 蓝色 (0,0,255) -->
            <usv led="color_select|0,0,255">
                <usv_id>usv_02</usv_id>
                <position>
                    <x>-6.0</x>
                    <y>-6.0</y>
                    <z>0.0</z>
                </position>
                <!-- 兼容旧写法 -->
                <yaw use="false">0</yaw>
                <velocity>
                    <value>0.5</value>
                </velocity>
            </usv>
            <!-- USV_03: 黄色 (255,255,0) -->
            <usv led="color_select|255,255,0">
                <usv_id>usv_03</usv_id>
                <position>
                    <x>-7.0</x>
                    <y>-7.0</y>
                    <z>0.0</z>
                </position>
                <yaw mode="auto" />
                <velocity>
                    <value>0.5</value>
                </velocity>
            </usv>
        </usvs>
    </step>

    <!-- 步骤 2: 目标点到达 & 原地旋转 (同步, 绿色完成色) -->
    <step number="3" sync="true">
        <usvs>
            <usv led="color_select|0,255,0">
                <usv_id>usv_01</usv_id>
                <position>
                    <x>5.0</x>
                    <y>0.0</y>
                    <z>0.0</z>
                </position>
                <!-- 强制指定朝向 -->
                <yaw mode="fixed">0.5</yaw>
                <velocity>
                    <value>0.5</value>
                </velocity>
            </usv>
            <usv led="color_select|0,255,0">
                <usv_id>usv_02</usv_id>
                <position>
                    <x>0.0</x>
                    <y>6.0</y>
                    <z>0.0</z>
                </position>
                
                <!-- 
                  MANEUVER: 动作定义
                  type="spin": 原地旋转
                  circles="3.0": 圈数
                  direction="ccw": 逆时针
                  
                  注意：当定义了 maneuver 时，不需要再定义 <yaw>
                -->
                <maneuver type="spin" circles="3.0" direction="ccw" />
                
                <velocity>
                    <value>0.5</value>
                </velocity>
            </usv>
            <usv led="color_select|0,255,0">
                <usv_id>usv_03</usv_id>
                <position>
                    <x>-5.0</x>
                    <y>0</y>
                    <z>0.0</z>
                </position>
                <yaw mode="fixed">0.5</yaw>
                <velocity>
                    <value>0.5</value>
                </velocity>
            </usv>
        </usvs>
    </step>
</cluster>
