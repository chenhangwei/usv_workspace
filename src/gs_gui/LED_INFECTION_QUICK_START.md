# LED传染模式快速使用指南

## 功能简介

LED传染模式允许距离接近的USV之间相互"传染"LED颜色。当两个USV距离小于2米时，ID较小的USV会将其LED颜色传染给ID较大的USV，被传染的USV会实时跟随传染源的LED颜色变化。

## 如何使用

### 开启传染模式（默认已开启）

1. 启动地面站GUI：
   ```bash
   ros2 launch gs_bringup gs_launch.py
   ```

2. 传染模式默认已开启（菜单中已勾选）

3. 当两个USV靠近（距离<2米）时：
   - 系统自动检测并触发传染
   - 被传染的USV LED会显示传染源的颜色
   - 传染源改变颜色时，被传染者会实时跟随变化

### 关闭传染模式

1. 点击菜单栏："LED设置" → 取消勾选"LED传染模式"
2. 系统自动恢复所有被传染USV的原始LED状态
3. 停止传染检测

### 重新开启

1. 点击菜单栏："LED设置" → 勾选"LED传染模式"
2. 系统重新开始检测和执行传染逻辑

## 传染规则

- **传染距离**: 2米
- **传染源**: USV ID较小的一方（如 usv_01 传染 usv_02）
- **实时跟随**: 被传染USV会持续跟随传染源的LED颜色变化
- **自动恢复**: 离开传染范围或关闭传染模式时，自动恢复原始状态

## 示例场景

### 场景1：两个USV靠近
1. usv_01 LED设置为红色
2. usv_02 LED设置为蓝色
3. 两个USV距离缩小到2米以内
4. usv_02 的LED自动变为红色（被传染）
5. 如果usv_01改变为绿色，usv_02会实时变为绿色
6. 两个USV距离拉大到2米以外
7. usv_02 的LED自动恢复为蓝色

### 场景2：手动关闭传染模式
1. usv_01 和 usv_02 距离小于2米，正在传染中
2. 用户通过菜单关闭"LED传染模式"
3. usv_02 立即恢复为原始蓝色
4. 即使两个USV仍然靠近，也不再发生传染

## 注意事项

- ✅ 传染模式默认开启
- ✅ 被传染USV会实时跟随传染源颜色变化
- ✅ 关闭模式时自动恢复所有被传染USV的状态
- ⚠️  传染状态不会保存，重启GUI后需要重新触发

## 故障排查

**问题：传染不生效**
- 检查菜单中"LED传染模式"是否已勾选
- 确认两个USV距离确实小于2米
- 查看日志确认传染检测是否正常运行

**问题：被传染USV颜色不更新**
- 检查传染源USV的LED是否正常工作
- 确认传染模式仍然开启
- 检查两个USV是否仍在传染范围内

---

**相关文档**: 详细功能说明请参考 `LED_INFECTION_MODE.md`
